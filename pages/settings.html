<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Settings</title>
    <link rel="stylesheet" href="http://yegor256.github.io/tacit/tacit.min.css"/>
  </head>
  <body>
    <div id="app">
      <article>
        <form v-on:submit.prevent="apply">
          <fieldset>
            <label for="watchDir">Directory to watch:</label>
            <button type="button" @click="openDir">Select Directory</button>
            <input name="watchDir" type="text" v-model="watchDir" style="display: inline-block" size="50">
          </fieldset>

          <label>Notifications enabled <input type="checkbox" v-model="notifications"></label>

          <label>Startup on Windows login<input type="checkbox" v-model="startOnLogin"></label>

          <button type="submit">Apply</button>
        </form>
      </article>
    </div>
    <!-- TODO use bootstrap -->
    <script>
      // Our connection back to the mainland, har har.
      const remote = require('electron').remote
      const settings = remote.require('./settings')

      let Vue = require('vue')

      let app = new Vue({
        el: '#app',
        data: {
          watchDir: 'C:\\',
          notifications: true,
          startOnLogin: false
        },
        methods: {
          openDir () {
            self = this
            remote.dialog.showOpenDialog({
              defaultPath: self.watchDir,
              properties: ['openDirectory']
            }, (dir) => {
              if (dir) {
                self.watchDir = dir[0]
              }
            })
          },
          apply () {
            settings.set('watchDir', this.watchDir)
            settings.set('notifications', this.notifications)
            settings.set('startOnLogin', this.startOnLogin)
          }
        },
        ready () {
          Object.assign(this.$data, settings.get())
        }
      })
    </script>
  </body>
</html>
